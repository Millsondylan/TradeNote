import{R as e}from"./ReactWrapper-z-iY-dVg.js";import{u as s,a,j as t}from"./UserContext-mo8_XTKz.js";import{r,z as l,f as c,u as i,o as n}from"./vendor-CBBAIpTX.js";import{l as o}from"./localDatabase-DxKw6VaK.js";import{P as d,S as m,F as x,b as h,T as p,a as b,d as u}from"./ui-Bs04w-Y-.js";import{_ as g,p as y}from"./main-LE54y1pd.js";import"./capacitor-3Yedw1XA.js";import"./database-ES7LaSYZ.js";const j=()=>{s();const[e,l]=r.useState([]),[c,i]=r.useState([]),[n,g]=r.useState(!0),[y,j]=r.useState(""),[f,N]=r.useState(!1),[v,w]=r.useState(""),[k,C]=r.useState("symbol"),P=a();r.useEffect(()=>{S();const e=setInterval(S,3e4);return()=>clearInterval(e)},[]),r.useEffect(()=>{A()},[e,y,k]);const S=async()=>{try{await o.initialize();const e=(await o.getWatchlist()).map(e=>{const s=.05*(Math.random()-.5),a=(e.currentPrice||100)*(1+s),t=a-(e.currentPrice||100),r=t/(e.currentPrice||100)*100;return{...e,currentPrice:a,change:t,changePercent:r,changeColor:t>=0?"text-success-400":"text-danger-400",isPositive:t>=0}});l(e)}catch(e){}finally{g(!1)}},A=()=>{let s=[...e];y&&(s=s.filter(e=>e.symbol.toLowerCase().includes(y.toLowerCase())||e.name&&e.name.toLowerCase().includes(y.toLowerCase()))),s.sort((e,s)=>{switch(k){case"symbol":return e.symbol.localeCompare(s.symbol);case"change":return(s.changePercent||0)-(e.changePercent||0);case"price":return(s.currentPrice||0)-(e.currentPrice||0);default:return 0}}),i(s)},F=async()=>{if(v.trim())try{const s=v.trim().toUpperCase();if(e.find(e=>e.symbol===s))return void alert("Symbol already in watchlist");const a={symbol:s,name:s,currentPrice:1e3*Math.random()+10,change:0,changePercent:0,addedAt:(new Date).toISOString()};await o.addToWatchlist(a),w(""),N(!1),await S()}catch(s){alert("Failed to add symbol to watchlist")}};return n?t.jsx("div",{className:"px-4 pt-4 pb-24 min-h-screen bg-gradient-to-br from-dark-900 via-dark-800 to-dark-900 flex items-center justify-center",children:t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-500 mx-auto mb-4"}),t.jsx("p",{className:"text-gray-400",children:"Loading watchlist..."})]})}):t.jsxs("div",{className:"px-4 pt-4 pb-24 min-h-screen bg-gradient-to-br from-dark-900 via-dark-800 to-dark-900",children:[t.jsxs("div",{className:"flex items-center justify-between mb-4",children:[t.jsx("h1",{className:"text-2xl font-bold text-primary-300 drop-shadow-glow",children:"Watchlist"}),t.jsx("button",{onClick:()=>N(!0),className:"bg-primary-500 hover:bg-primary-600 text-white rounded-full px-4 py-2 shadow-holographic transition-all duration-200 active:scale-95",children:t.jsx(d,{className:"w-4 h-4"})})]}),t.jsxs("div",{className:"mb-6 space-y-4",children:[t.jsxs("div",{className:"relative",children:[t.jsx(m,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),t.jsx("input",{type:"text",value:y,onChange:e=>j(e.target.value),placeholder:"Search symbols...",className:"w-full pl-10 pr-4 py-3 bg-dark-700 border border-dark-600 rounded-lg text-white placeholder-gray-400 focus:border-primary-500 focus:ring-1 focus:ring-primary-500 transition-colors"})]}),t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx(x,{className:"w-4 h-4 text-gray-400"}),t.jsx("span",{className:"text-gray-400 text-sm",children:"Sort by:"}),t.jsxs("select",{value:k,onChange:e=>C(e.target.value),className:"bg-dark-700 border border-dark-600 rounded-lg px-3 py-1 text-white text-sm",children:[t.jsx("option",{value:"symbol",children:"Symbol"}),t.jsx("option",{value:"change",children:"Change %"}),t.jsx("option",{value:"price",children:"Price"})]})]})]}),f&&t.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-50",children:t.jsxs("div",{className:"bg-dark-800 rounded-xl p-6 w-full max-w-md shadow-glass backdrop-blur-xs border border-dark-700",children:[t.jsx("h2",{className:"text-xl font-bold text-white mb-4",children:"Add to Watchlist"}),t.jsxs("div",{className:"mb-4",children:[t.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Symbol"}),t.jsx("input",{type:"text",value:v,onChange:e=>w(e.target.value.toUpperCase()),placeholder:"Enter stock symbol (e.g., AAPL)",className:"w-full px-3 py-2 bg-dark-700 border border-dark-600 rounded-lg text-white",onKeyPress:e=>"Enter"===e.key&&F()})]}),t.jsxs("div",{className:"flex space-x-3",children:[t.jsx("button",{onClick:()=>{N(!1),w("")},className:"flex-1 bg-dark-700 hover:bg-dark-600 text-white py-2 rounded-lg transition-colors",children:"Cancel"}),t.jsx("button",{onClick:F,className:"flex-1 bg-primary-500 hover:bg-primary-600 text-white py-2 rounded-lg transition-colors",children:"Add Symbol"})]})]})}),t.jsx("div",{className:"space-y-4",children:0===c.length?t.jsxs("div",{className:"text-center py-12",children:[t.jsx(h,{className:"w-16 h-16 text-gray-600 mx-auto mb-4"}),t.jsx("h3",{className:"text-xl font-semibold text-gray-400 mb-2",children:0===e.length?"No Watchlist Items":"No Matching Symbols"}),t.jsx("p",{className:"text-gray-500 mb-4",children:0===e.length?"Add your first symbol to start tracking":"Try adjusting your search or filters"}),0===e.length&&t.jsx("button",{onClick:()=>N(!0),className:"bg-primary-500 hover:bg-primary-600 text-white px-6 py-2 rounded-lg transition-colors",children:"Add First Symbol"})]}):c.map(e=>t.jsxs("div",{className:"bg-dark-800/70 rounded-xl p-4 shadow-glass backdrop-blur-xs border border-dark-700",children:[t.jsxs("div",{className:"flex items-center justify-between mb-3",children:[t.jsxs("div",{className:"flex items-center space-x-3",children:[t.jsx("div",{className:"text-primary-400",children:t.jsx(h,{className:"w-5 h-5 fill-current"})}),t.jsxs("div",{children:[t.jsx("h3",{className:"font-semibold text-white text-lg",children:e.symbol}),t.jsx("p",{className:"text-gray-400 text-sm",children:e.name||"Loading..."})]})]}),t.jsxs("div",{className:"flex items-center space-x-2",children:[e.isPositive?t.jsx(p,{className:"w-4 h-4 text-success-400"}):t.jsx(b,{className:"w-4 h-4 text-danger-400"}),t.jsxs("span",{className:`text-sm font-bold ${e.changeColor}`,children:[e.changePercent&&e.changePercent>=0?"+":"",e.changePercent?.toFixed(2),"%"]})]})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[t.jsxs("div",{className:"space-y-1",children:[t.jsxs("div",{className:"flex items-center justify-between text-sm",children:[t.jsx("span",{className:"text-gray-400",children:"Current Price"}),t.jsxs("span",{className:"text-white font-medium",children:["$",e.currentPrice?.toFixed(2)]})]}),t.jsxs("div",{className:"flex items-center justify-between text-sm",children:[t.jsx("span",{className:"text-gray-400",children:"Change"}),t.jsxs("span",{className:`font-medium ${e.changeColor}`,children:[e.change&&e.change>=0?"+":"","$",e.change?.toFixed(2)]})]})]}),t.jsxs("div",{className:"space-y-1",children:[t.jsxs("div",{className:"flex items-center justify-between text-sm",children:[t.jsx("span",{className:"text-gray-400",children:"Added"}),t.jsx("span",{className:"text-white",children:new Date(e.addedAt).toLocaleDateString()})]}),t.jsxs("div",{className:"flex items-center justify-between text-sm",children:[t.jsx("span",{className:"text-gray-400",children:"Status"}),t.jsx("span",{className:"text-success-400",children:"Active"})]})]})]}),t.jsxs("div",{className:"flex space-x-2",children:[t.jsx("button",{onClick:()=>{return s=e.symbol,void P("/add-trade",{state:{symbol:s}});var s},className:"flex-1 bg-primary-500 hover:bg-primary-600 text-white py-2 px-3 rounded-lg text-sm transition-colors",children:"Quick Trade"}),t.jsx("button",{onClick:()=>(async e=>{try{await o.removeFromWatchlist(e),await S()}catch(s){alert("Failed to remove symbol from watchlist")}})(e.symbol),className:"bg-danger-500 hover:bg-danger-600 text-white py-2 px-3 rounded-lg text-sm transition-colors",children:t.jsx(u,{className:"w-4 h-4"})})]})]},e.symbol))})]})},f={class:"watchlist-view"},N=g({__name:"Watchlist",setup:s=>(y.value="watchlist",(s,a)=>(n(),l("div",f,[c(e,{component:i(j)},null,8,["component"])])))},[["__scopeId","data-v-2d4ed47a"]]);export{N as default};
