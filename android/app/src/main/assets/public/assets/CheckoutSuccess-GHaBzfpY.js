import{M as e,N as s,O as t,Q as a,R as n,S as o,T as i,U as c,u as r,c8 as l,b9 as d,d as u,P as m}from"./main-LE54y1pd.js";import{x as p,z as w,o as y,B as h,C as f}from"./vendor-CBBAIpTX.js";import"./capacitor-3Yedw1XA.js";import"./ui-Bs04w-Y-.js";const x={class:"row justify-content-md-center"},b=[h("div",{class:"col-12 col-md-8 text-center"},[h("p",null,[f("We appreciate your business! A confirmation email will be sent to "),h("span",{id:"customer-email"}),f(".")]),h("p",null,[f("If you have any questions, please email "),h("a",{href:"mailto:hello@eleven.trading"},"hello@eleven.trading"),f(". ")])],-1)],v={__name:"CheckoutSuccess",setup(h){e.extend(s),e.extend(t),e.extend(a),e.extend(n),e.extend(o),e.extend(i),e.extend(c),p(async()=>{await r();try{await l(d.value),window.location.replace("/dashboard")}catch(e){403==await f()&&window.location.replace("/dashboard")}});const f=async()=>{const e=window.location.search,s=new URLSearchParams(e).get("session_id");if(!s)return 403;try{const e=(await u.get("/api/session-status",{params:{session_id:s}})).data;if("open"===e.status)window.location.replace("/checkout");else if("complete"===e.status){document.getElementById("customer-email").textContent=e.customer_email;await async function(e){return new Promise(async(s,t)=>{const a=m.Object.extend("_User"),n=new m.Query(a);n.equalTo("objectId",d.value.objectId);const o=await n.first();o?(o.set("paymentService",e),await o.save().then(async()=>{})):alert("Update query did not return any results"),s()})}({customerId:e.session.customer,subscriptionId:e.session.subscription})}}catch(t){t.response||t.request}};return(e,s)=>(y(),w("div",x,b))}};export{v as default};
