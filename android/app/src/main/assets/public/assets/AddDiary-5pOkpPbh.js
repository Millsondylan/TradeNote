import{x as a,z as e,f as t,B as s,J as n,K as o,u as l,F as r,H as i,P as d,Q as c,O as u,M as m,I as p,o as f,C as v,E as y,D as b}from"./vendor-CBBAIpTX.js";import{_ as g}from"./SpinnerLoadingPage-SCQtX8pf.js";import{M as w,N as x,O as D,Q as k,R as Y,S as h,T as M,U as C,bJ as P,ay as U,B as I,a5 as S,f as j,bK as O,bL as q,bM as E,bN as F,P as J,ah as N,i as Q,m as T,af as z,aG as B,aR as K,aS as L,aT as _,a8 as A,aU as H,aV as R,bO as V,bP as G,bQ as W}from"./main-LE54y1pd.js";import"./capacitor-3Yedw1XA.js";import"./ui-Bs04w-Y-.js";const X={class:"row mt-2"},Z={class:"mt-3 input-group mb-3"},$=["value"],aa={class:"container-tags col"},ea={class:"form-control dropdown form-select",style:{height:"auto"}},ta={style:{display:"flex","align-items":"center","flex-wrap":"wrap"}},sa=["onClick"],na=s("span",{class:"remove-tag"},"Ã—",-1),oa=["onClick"],la={class:"ms-2"},ra=s("div",{class:"mt-2"},[s("div",{id:"quillEditorDiary"})],-1),ia=["disabled"],da=[s("span",{class:"progress-bar-text"},"Submit",-1)],ca=s("div",{class:"mt-3"},[s("button",{type:"cancel",onclick:"location.href = '/diary';",class:"btn btn-outline-secondary btn-sm"},"Cancel")],-1),ua={__name:"AddDiary",setup(ua){w.extend(x),w.extend(D),w.extend(k),w.extend(Y),w.extend(h),w.extend(M),w.extend(C);let ma={};function pa(a){E.dateUnix=w.tz(a,U.value).unix(),E.date=w(1e3*E.dateUnix).format("YYYY-MM-DD"),E.dateDateFormat=new Date(E.date)}return P.value=w().tz(U.value).format("YYYY-MM-DD"),a(async()=>{await(I.value=!0),await Promise.all([S(),j(),pa(P.value),O("Diary")]),await async function(){return new Promise(async(a,e)=>{E.diary={},a()})}(),await async function(a){if(!a)return;F.value=a;const e=J.Object.extend("diaries"),t=new J.Query(e);t.equalTo("objectId",a);const s=await t.first();if(s){ma=JSON.parse(JSON.stringify(s)),E.dateUnix=ma.dateUnix,E.date=w.unix(ma.dateUnix).format("YYYY-MM-DD"),E.dateDateFormat=new Date(E.date),document.querySelector("#quillEditorDiary .ql-editor").innerHTML=ma.diary;let a=N.find(a=>a.tradeId==E.dateUnix);a&&a.tags.forEach(a=>{for(let e of Q)for(let t of e.tags)if(t.id===a){let a={};a.id=t.id,a.name=t.name,T.push(a)}})}}(q.value),await sessionStorage.removeItem("editItemId"),await(I.value=!1)}),(a,w)=>(f(),e(r,null,[t(g),s("div",X,[s("div",null,[n(s("div",null,[s("div",Z,[s("input",{type:"date",class:"form-control",value:l(E).hasOwnProperty("date")?l(E).date:l(E).date=l(P),onInput:w[0]||(w[0]=a=>pa(a.target.value))},null,40,$)]),s("div",aa,[s("div",ea,[s("div",ta,[(f(!0),e(r,null,i(l(T),(a,t)=>(f(),e("span",{key:t,class:"tag txt-small",style:p({"background-color":l(B)(a.id).groupColor}),onClick:a=>l(K)("remove",t)},[v(y(a.name),1),na],12,sa))),128)),n(s("input",{type:"text","onUpdate:modelValue":w[1]||(w[1]=a=>d(z)?z.value=a:null),onInput:w[2]||(w[2]=(...a)=>l(L)&&l(L)(...a)),onKeydown:[w[3]||(w[3]=c(u(a=>l(K)("add",l(z)),["prevent"]),["enter"])),w[4]||(w[4]=c(u(a=>l(K)("add",l(z)),["prevent"]),["tab"]))],class:"form-control tag-input",placeholder:"Add a tag"},null,544),[[m,l(z)]]),s("div",{class:"clickable-area",onClick:w[5]||(w[5]=(...a)=>l(_)&&l(_)(...a))})])]),s("ul",{id:"dropdown-menu-tags",class:"dropdown-menu-tags",style:p([l(A)?"":"border: none;"])},[(f(!0),e(r,null,i(l(Q),a=>n((f(),e("span",null,[n(s("h6",{class:"p-1 mb-0",style:p("background-color: "+a.color+";")},y(a.name),5),[[o,l(H)(a.id).filter(e=>e.id==a.id)[0].tags.length>0]]),(f(!0),e(r,null,i(l(H)(a.id).filter(e=>e.id==a.id)[0].tags,(a,t)=>(f(),e("li",{key:t,class:b([{active:t===l(R)},"dropdown-item dropdown-item-tags"]),onClick:e=>l(K)("addFromDropdownMenu",a)},[s("span",la,y(a.name),1)],10,oa))),128))],512)),[[o,l(A)]])),256))],4)]),ra,s("div",{class:"progress buttonProgress mt-3",role:"progressbar",disabled:!l(V),type:"button",onClick:w[6]||(w[6]=a=>l(G)())},[s("div",{class:"progress-bar buttonProgressBar text-center",style:p({width:(5-l(W))/5*100+"%"})},da,4)],8,ia),ca],512),[[o,!l(I)]])])])],64))}};export{ua as default};
