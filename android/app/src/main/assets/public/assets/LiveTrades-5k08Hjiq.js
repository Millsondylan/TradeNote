import{R as e}from"./ReactWrapper-z-iY-dVg.js";import{u as s,a as t,j as a}from"./UserContext-mo8_XTKz.js";import{r,z as n,f as i,u as c,o as l}from"./vendor-CBBAIpTX.js";import{l as d}from"./localDatabase-DxKw6VaK.js";import{T as x,a as m}from"./ui-Bs04w-Y-.js";import{_ as o,p}from"./main-LE54y1pd.js";import"./capacitor-3Yedw1XA.js";import"./database-ES7LaSYZ.js";const h=()=>{s();const[e,n]=r.useState([]),[i,c]=r.useState(!0),l=t();r.useEffect(()=>{o();const e=setInterval(o,3e4);return()=>clearInterval(e)},[]);const o=async()=>{try{await d.initialize();const e=await d.getTrades(),s=e.filter(e=>!e.exitDate).map(e=>{const s=.1*(Math.random()-.5),t=e.entryPrice*(1+s),a=(t-e.entryPrice)*e.quantity,r=(t-e.entryPrice)/e.entryPrice*100;return{...e,currentPrice:t,unrealizedPnL:a,pnlPercent:r}});n(s)}catch(e){}finally{c(!1)}},p=()=>e.reduce((e,s)=>e+(s.unrealizedPnL||0),0);return i?a.jsx("div",{className:"px-4 pt-4 pb-24 min-h-screen bg-gradient-to-br from-dark-900 via-dark-800 to-dark-900 flex items-center justify-center",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-500 mx-auto mb-4"}),a.jsx("p",{className:"text-gray-400",children:"Loading live trades..."})]})}):a.jsxs("div",{className:"px-4 pt-4 pb-24 min-h-screen bg-gradient-to-br from-dark-900 via-dark-800 to-dark-900",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsx("h1",{className:"text-2xl font-bold text-primary-300 drop-shadow-glow",children:"Live Trades"}),a.jsx("button",{className:"bg-primary-500 hover:bg-primary-600 text-white rounded-full px-4 py-2 shadow-holographic transition-all duration-200 active:scale-95",onClick:()=>l("/add-trade"),children:"+ New Trade"})]}),a.jsxs("div",{className:"bg-dark-800/70 rounded-xl p-4 mb-6 shadow-glass backdrop-blur-xs border border-dark-700",children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsx("span",{className:"text-gray-400 text-sm",children:"Total Unrealized P&L"}),a.jsxs("span",{className:"text-lg font-bold "+(p()>=0?"text-success-400":"text-danger-400"),children:[p()>=0?"+":"","$",p().toFixed(2)]})]}),a.jsxs("div",{className:"flex items-center justify-between text-sm text-gray-400",children:[a.jsxs("span",{children:[e.length," Open Trades"]}),a.jsx("span",{className:"text-primary-400",children:"Live Updates"})]})]}),a.jsx("div",{className:"space-y-4",children:0===e.length?a.jsxs("div",{className:"text-center py-12",children:[a.jsx(x,{className:"w-16 h-16 text-gray-600 mx-auto mb-4"}),a.jsx("h3",{className:"text-xl font-semibold text-gray-400 mb-2",children:"No Open Trades"}),a.jsx("p",{className:"text-gray-500 mb-4",children:"Start your first trade to see it here"}),a.jsx("button",{onClick:()=>l("/add-trade"),className:"bg-primary-500 hover:bg-primary-600 text-white px-6 py-2 rounded-lg transition-colors",children:"Add Your First Trade"})]}):e.map(s=>a.jsxs("div",{className:"bg-dark-800/70 rounded-xl p-4 shadow-glass backdrop-blur-xs border border-dark-700",children:[a.jsxs("div",{className:"flex items-center justify-between mb-3",children:[a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx("span",{className:"font-semibold text-primary-200 text-lg",children:s.symbol}),a.jsx("span",{className:"px-2 py-1 rounded-full text-xs font-medium "+("buy"===s.type?"bg-success-500/20 text-success-400":"bg-danger-500/20 text-danger-400"),children:s.type.toUpperCase()})]}),a.jsxs("div",{className:"flex items-center space-x-2",children:[s.unrealizedPnL&&s.unrealizedPnL>=0?a.jsx(x,{className:"w-4 h-4 text-success-400"}):a.jsx(m,{className:"w-4 h-4 text-danger-400"}),a.jsxs("span",{className:"text-sm font-bold "+(s.unrealizedPnL&&s.unrealizedPnL>=0?"text-success-400":"text-danger-400"),children:[s.unrealizedPnL&&s.unrealizedPnL>=0?"+":"","$",s.unrealizedPnL?.toFixed(2)]})]})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"flex items-center justify-between text-sm",children:[a.jsx("span",{className:"text-gray-400",children:"Entry Price"}),a.jsxs("span",{className:"text-white",children:["$",s.entryPrice]})]}),a.jsxs("div",{className:"flex items-center justify-between text-sm",children:[a.jsx("span",{className:"text-gray-400",children:"Current Price"}),a.jsxs("span",{className:"text-primary-300",children:["$",s.currentPrice?.toFixed(2)]})]}),a.jsxs("div",{className:"flex items-center justify-between text-sm",children:[a.jsx("span",{className:"text-gray-400",children:"Quantity"}),a.jsx("span",{className:"text-white",children:s.quantity})]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"flex items-center justify-between text-sm",children:[a.jsx("span",{className:"text-gray-400",children:"P&L %"}),a.jsxs("span",{className:"font-medium "+(s.pnlPercent&&s.pnlPercent>=0?"text-success-400":"text-danger-400"),children:[s.pnlPercent&&s.pnlPercent>=0?"+":"",s.pnlPercent?.toFixed(2),"%"]})]}),a.jsxs("div",{className:"flex items-center justify-between text-sm",children:[a.jsx("span",{className:"text-gray-400",children:"Duration"}),a.jsxs("span",{className:"text-white",children:[Math.floor((Date.now()-new Date(s.entryDate).getTime())/864e5),"d"]})]}),a.jsxs("div",{className:"flex items-center justify-between text-sm",children:[a.jsx("span",{className:"text-gray-400",children:"Strategy"}),a.jsx("span",{className:"text-white",children:s.strategy||"N/A"})]})]})]}),a.jsxs("div",{className:"flex space-x-2",children:[a.jsx("button",{onClick:()=>l(`/journal/${s.id}`),className:"flex-1 bg-dark-700 hover:bg-dark-600 text-white py-2 px-3 rounded-lg text-sm transition-colors",children:"View Details"}),a.jsx("button",{onClick:()=>{const t=prompt("Enter exit price:");t&&!isNaN(Number(t))&&(async(s,t)=>{try{const a=e.find(e=>e.id===s);if(!a)return;const r=(t-a.entryPrice)*a.quantity,n={...a,exitPrice:t,exitDate:(new Date).toISOString(),profit:r,updatedAt:(new Date).toISOString()};await d.updateTrade(n),await o()}catch(a){alert("Failed to close trade")}})(s.id,Number(t))},className:"bg-danger-500 hover:bg-danger-600 text-white py-2 px-3 rounded-lg text-sm transition-colors",children:"Close Trade"})]})]},s.id))})]})},u={class:"live-trades-view"},j=o({__name:"LiveTrades",setup:s=>(p.value="live-trades",(s,t)=>(l(),n("div",u,[i(e,{component:c(h)},null,8,["component"])])))},[["__scopeId","data-v-ddcd9d7e"]]);export{j as default};
