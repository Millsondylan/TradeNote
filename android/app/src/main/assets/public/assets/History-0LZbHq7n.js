import{R as e}from"./ReactWrapper-z-iY-dVg.js";import{u as t,a as s,j as a}from"./UserContext-mo8_XTKz.js";import{r,z as l,f as i,u as n,o as d}from"./vendor-CBBAIpTX.js";import{l as o}from"./localDatabase-DxKw6VaK.js";import{F as c,B as x,T as m,a as p}from"./ui-Bs04w-Y-.js";import{_ as h,p as b}from"./main-LE54y1pd.js";import"./capacitor-3Yedw1XA.js";import"./database-ES7LaSYZ.js";const f=()=>{t();const[e,l]=r.useState([]),[i,n]=r.useState([]),[d,h]=r.useState(null),[b,f]=r.useState(!0),[u,g]=r.useState({symbol:"",type:"",startDate:"",endDate:"",minProfit:"",maxProfit:""}),[j,y]=r.useState(!1),N=s();r.useEffect(()=>{v()},[]),r.useEffect(()=>{k()},[e,u]);const v=async()=>{try{await o.initialize();const e=(await o.getTrades()).filter(e=>e.exitDate&&void 0!==e.profit);l(e),w(e)}catch(e){}finally{f(!1)}},w=e=>{const t=e.filter(e=>e.profit&&e.profit>0),s=e.filter(e=>e.profit&&e.profit<0),a=t.reduce((e,t)=>e+(t.profit||0),0),r=Math.abs(s.reduce((e,t)=>e+(t.profit||0),0)),l=e.reduce((e,t)=>e+(t.profit||0),0),i={totalTrades:e.length,winningTrades:t.length,losingTrades:s.length,winRate:e.length>0?t.length/e.length*100:0,totalProfit:a,totalLoss:r,netProfit:l,averageWin:t.length>0?a/t.length:0,averageLoss:s.length>0?r/s.length:0,profitFactor:r>0?a/r:0,largestWin:Math.max(...e.map(e=>e.profit||0)),largestLoss:Math.min(...e.map(e=>e.profit||0))};h(i)},k=()=>{let t=[...e];u.symbol&&(t=t.filter(e=>e.symbol.toLowerCase().includes(u.symbol.toLowerCase()))),u.type&&(t=t.filter(e=>e.type===u.type)),u.startDate&&(t=t.filter(e=>e.entryDate>=u.startDate)),u.endDate&&(t=t.filter(e=>e.entryDate<=u.endDate)),u.minProfit&&(t=t.filter(e=>(e.profit||0)>=Number(u.minProfit))),u.maxProfit&&(t=t.filter(e=>(e.profit||0)<=Number(u.maxProfit))),n(t)};return b?a.jsx("div",{className:"px-4 pt-4 pb-24 min-h-screen bg-gradient-to-br from-dark-900 via-dark-800 to-dark-900 flex items-center justify-center",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-500 mx-auto mb-4"}),a.jsx("p",{className:"text-gray-400",children:"Loading trading history..."})]})}):a.jsxs("div",{className:"px-4 pt-4 pb-24 min-h-screen bg-gradient-to-br from-dark-900 via-dark-800 to-dark-900",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsx("h1",{className:"text-2xl font-bold text-primary-300 drop-shadow-glow",children:"Trading History"}),a.jsx("button",{onClick:()=>y(!j),className:"bg-dark-700 hover:bg-dark-600 text-white rounded-full p-2 shadow-glass transition-all duration-200",children:a.jsx(c,{className:"w-5 h-5"})})]}),j&&a.jsxs("div",{className:"bg-dark-800/70 rounded-xl p-4 mb-6 shadow-glass backdrop-blur-xs border border-dark-700",children:[a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Symbol"}),a.jsx("input",{type:"text",value:u.symbol,onChange:e=>g(t=>({...t,symbol:e.target.value})),className:"w-full px-3 py-2 bg-dark-700 border border-dark-600 rounded-lg text-white text-sm",placeholder:"Filter by symbol"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Type"}),a.jsxs("select",{value:u.type,onChange:e=>g(t=>({...t,type:e.target.value})),className:"w-full px-3 py-2 bg-dark-700 border border-dark-600 rounded-lg text-white text-sm",children:[a.jsx("option",{value:"",children:"All Types"}),a.jsx("option",{value:"buy",children:"Buy"}),a.jsx("option",{value:"sell",children:"Sell"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Start Date"}),a.jsx("input",{type:"date",value:u.startDate,onChange:e=>g(t=>({...t,startDate:e.target.value})),className:"w-full px-3 py-2 bg-dark-700 border border-dark-600 rounded-lg text-white text-sm"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"End Date"}),a.jsx("input",{type:"date",value:u.endDate,onChange:e=>g(t=>({...t,endDate:e.target.value})),className:"w-full px-3 py-2 bg-dark-700 border border-dark-600 rounded-lg text-white text-sm"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Min Profit"}),a.jsx("input",{type:"number",value:u.minProfit,onChange:e=>g(t=>({...t,minProfit:e.target.value})),className:"w-full px-3 py-2 bg-dark-700 border border-dark-600 rounded-lg text-white text-sm",placeholder:"Min profit"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Max Profit"}),a.jsx("input",{type:"number",value:u.maxProfit,onChange:e=>g(t=>({...t,maxProfit:e.target.value})),className:"w-full px-3 py-2 bg-dark-700 border border-dark-600 rounded-lg text-white text-sm",placeholder:"Max profit"})]})]}),a.jsxs("div",{className:"flex justify-between mt-4",children:[a.jsx("button",{onClick:()=>{g({symbol:"",type:"",startDate:"",endDate:"",minProfit:"",maxProfit:""})},className:"text-gray-400 hover:text-white text-sm transition-colors",children:"Clear Filters"}),a.jsxs("span",{className:"text-sm text-gray-400",children:[i.length," of ",e.length," trades"]})]})]}),d&&a.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-6",children:[a.jsxs("div",{className:"bg-dark-800/70 rounded-xl p-4 shadow-glass backdrop-blur-xs border border-dark-700",children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsx("span",{className:"text-gray-400 text-sm",children:"Net Profit"}),a.jsxs("span",{className:"text-lg font-bold "+(d.netProfit>=0?"text-success-400":"text-danger-400"),children:[d.netProfit>=0?"+":"","$",d.netProfit.toFixed(2)]})]}),a.jsxs("div",{className:"flex items-center justify-between text-sm text-gray-400",children:[a.jsx("span",{children:"Win Rate"}),a.jsxs("span",{className:"text-primary-400",children:[d.winRate.toFixed(1),"%"]})]})]}),a.jsxs("div",{className:"bg-dark-800/70 rounded-xl p-4 shadow-glass backdrop-blur-xs border border-dark-700",children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsx("span",{className:"text-gray-400 text-sm",children:"Total Trades"}),a.jsx("span",{className:"text-lg font-bold text-white",children:d.totalTrades})]}),a.jsxs("div",{className:"flex items-center justify-between text-sm text-gray-400",children:[a.jsx("span",{children:"Profit Factor"}),a.jsx("span",{className:"text-primary-400",children:d.profitFactor.toFixed(2)})]})]})]}),a.jsx("div",{className:"space-y-4",children:0===i.length?a.jsxs("div",{className:"text-center py-12",children:[a.jsx(x,{className:"w-16 h-16 text-gray-600 mx-auto mb-4"}),a.jsx("h3",{className:"text-xl font-semibold text-gray-400 mb-2",children:"No Trades Found"}),a.jsx("p",{className:"text-gray-500 mb-4",children:0===e.length?"Complete your first trade to see it here":"No trades match your filters"}),0===e.length&&a.jsx("button",{onClick:()=>N("/add-trade"),className:"bg-primary-500 hover:bg-primary-600 text-white px-6 py-2 rounded-lg transition-colors",children:"Add Your First Trade"})]}):i.map(e=>a.jsxs("div",{className:"bg-dark-800/70 rounded-xl p-4 shadow-glass backdrop-blur-xs border border-dark-700",children:[a.jsxs("div",{className:"flex items-center justify-between mb-3",children:[a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx("span",{className:"font-semibold text-primary-200 text-lg",children:e.symbol}),a.jsx("span",{className:"px-2 py-1 rounded-full text-xs font-medium "+("buy"===e.type?"bg-success-500/20 text-success-400":"bg-danger-500/20 text-danger-400"),children:e.type.toUpperCase()})]}),a.jsxs("div",{className:"flex items-center space-x-2",children:[e.profit&&e.profit>=0?a.jsx(m,{className:"w-4 h-4 text-success-400"}):a.jsx(p,{className:"w-4 h-4 text-danger-400"}),a.jsxs("span",{className:"text-sm font-bold "+(e.profit&&e.profit>=0?"text-success-400":"text-danger-400"),children:[e.profit&&e.profit>=0?"+":"","$",e.profit?.toFixed(2)]})]})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-3",children:[a.jsxs("div",{className:"space-y-1",children:[a.jsxs("div",{className:"flex items-center justify-between text-sm",children:[a.jsx("span",{className:"text-gray-400",children:"Entry"}),a.jsxs("span",{className:"text-white",children:["$",e.entryPrice]})]}),a.jsxs("div",{className:"flex items-center justify-between text-sm",children:[a.jsx("span",{className:"text-gray-400",children:"Exit"}),a.jsxs("span",{className:"text-white",children:["$",e.exitPrice]})]})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsxs("div",{className:"flex items-center justify-between text-sm",children:[a.jsx("span",{className:"text-gray-400",children:"Quantity"}),a.jsx("span",{className:"text-white",children:e.quantity})]}),a.jsxs("div",{className:"flex items-center justify-between text-sm",children:[a.jsx("span",{className:"text-gray-400",children:"Duration"}),a.jsxs("span",{className:"text-white",children:[Math.floor((new Date(e.exitDate).getTime()-new Date(e.entryDate).getTime())/864e5),"d"]})]})]})]}),a.jsx("div",{className:"flex justify-end",children:a.jsx("button",{onClick:()=>N(`/journal/${e.id}`),className:"text-primary-400 hover:text-primary-300 text-sm transition-colors",children:"View Details"})})]},e.id))})]})},u={class:"history-view"},g=h({__name:"History",setup:t=>(b.value="history",(t,s)=>(d(),l("div",u,[i(e,{component:n(f)},null,8,["component"])])))},[["__scopeId","data-v-7c1e479b"]]);export{g as default};
