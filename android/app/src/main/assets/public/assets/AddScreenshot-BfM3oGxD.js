import{x as a,z as e,f as s,J as l,K as t,u as n,B as o,F as i,H as r,N as d,G as c,P as u,Q as p,O as m,M as v,I as y,c as b,o as f,E as g,C as w,D as h}from"./vendor-CBBAIpTX.js";import{_ as x}from"./SpinnerLoadingPage-SCQtX8pf.js";import{M as k,N as S,O as C,Q as I,R as j,S as O,T as U,U as B,B as P,al as M,a5 as T,f as V,bL as D,bJ as J,ay as N,bV as Y,P as z,at as E,ah as G,i as H,m as Q,af as _,ap as A,bW as F,bX as K,aG as L,aR as R,aS as W,aT as q,a8 as X,aU as Z,aV as $,aW as aa,a7 as ea}from"./main-LE54y1pd.js";import"./capacitor-3Yedw1XA.js";import"./ui-Bs04w-Y-.js";const sa={class:"row mt-3 mb-3"},la={class:"col-12 mb-2"},ta={class:"row"},na={class:"col"},oa=["value"],ia={class:"col"},ra=["step","value"],da={class:"col"},ca=["value"],ua={class:"col-12"},pa={class:"row"},ma={key:0,class:"col"},va=["value"],ya={class:"container-tags col"},ba={class:"form-control dropdown form-select",style:{height:"auto"}},fa={style:{display:"flex","align-items":"center","flex-wrap":"wrap"}},ga=["onClick"],wa=o("span",{class:"remove-tag"},"Ã—",-1),ha=["onClick"],xa={class:"ms-2"},ka={class:"mt-3"},Sa={class:"fst-italic fw-lighter text-center"},Ca=[o("small",null,[w("Click on "),o("i",{class:"uil uil-image-edit ms-2 me-2"}),w(" to mark & annotate")],-1)],Ia={class:"mt-3 mb-3"},ja=o("div",{class:"mt-3"},[o("button",{type:"cancel",onclick:"location.href = '/screenshots';",class:"btn btn-outline-secondary btn-sm"},"Cancel")],-1),Oa={__name:"AddScreenshot",setup(Oa){k.extend(S),k.extend(C),k.extend(I),k.extend(j),k.extend(O),k.extend(U),k.extend(B),a(async()=>{await(P.value=!0),await M(),await Promise.all([T(),V()]),await async function(a){if(!a)return;Y.value=!0;const e=z.Object.extend("screenshots"),s=new z.Query(e);s.equalTo("objectId",a);const l=await s.first();if(l){for(let e in E)delete E[e];Object.assign(E,JSON.parse(JSON.stringify(l))),E.side?E.type="entry":E.type="setup";let a=G.find(a=>a.tradeId==E.name);a&&a.tags.forEach(a=>{for(let e of H)for(let s of e.tags)if(s.id===a){let a={};a.id=s.id,a.name=s.name,Q.push(a)}})}}(D.value),await sessionStorage.removeItem("editItemId"),await(P.value=!1)}),J.value=k().tz(N.value).format("YYYY-MM-DD HH:mm");let Ua=[{value:null,label:"Type"},{value:"setup",label:"General Setup"},{value:"entry",label:"Trade Entry"}],Ba=[{value:null,label:"Side"},{value:"SS",label:"Short"},{value:"B",label:"Buy"}];return(a,S)=>(f(),e(i,null,[s(x),l(o("div",null,[o("div",sa,[o("div",la,[o("div",ta,[o("div",na,[l(o("select",{"onUpdate:modelValue":S[0]||(S[0]=a=>n(E).type=a),class:"form-select"},[(f(!0),e(i,null,r(n(Ua),a=>(f(),e("option",{value:a.value},g(a.label),9,oa))),256))],512),[[d,n(E).type]])]),o("div",ia,[o("input",{type:"datetime-local",step:"setup"==n(E).type?"":"1",class:"form-control",value:n(E).hasOwnProperty("dateUnix")?n(K)(n(E).dateUnix):n(J),onInput:S[1]||(S[1]=a=>{return e=a.target.value,Y.value&&(F.value=!0),E.date=e,void(E.dateUnix=k.tz(E.date,N.value).unix());var e})},null,40,ra)]),o("div",da,[o("input",{type:"text",class:"form-control",value:n(E).hasOwnProperty("symbol")?n(E).symbol:"",onInput:S[2]||(S[2]=a=>n(E).symbol=a.target.value),placeholder:"Symbol"},null,40,ca)])])]),o("div",ua,[o("div",pa,["entry"==n(E).type?(f(),e("div",ma,[l(o("select",{"onUpdate:modelValue":S[3]||(S[3]=a=>n(E).side=a),class:"form-select"},[(f(!0),e(i,null,r(n(Ba),a=>(f(),e("option",{value:a.value},g(a.label),9,va))),256))],512),[[d,n(E).side]])])):c("",!0),o("div",ya,[o("div",ba,[o("div",fa,[(f(!0),e(i,null,r(n(Q),(a,s)=>(f(),e("span",{key:s,class:"tag txt-small",style:y({"background-color":n(L)(a.id).groupColor}),onClick:a=>n(R)("remove",s)},[w(g(a.name),1),wa],12,ga))),128)),l(o("input",{type:"text","onUpdate:modelValue":S[4]||(S[4]=a=>u(_)?_.value=a:null),onInput:S[5]||(S[5]=(...a)=>n(W)&&n(W)(...a)),onKeydown:[S[6]||(S[6]=p(m(a=>n(R)("add",n(_)),["prevent"]),["enter"])),S[7]||(S[7]=p(m(a=>n(R)("add",n(_)),["prevent"]),["tab"]))],class:"form-control tag-input",placeholder:"Add a tag"},null,544),[[v,n(_)]]),o("div",{class:"clickable-area",onClick:S[8]||(S[8]=(...a)=>n(q)&&n(q)(...a))})])]),o("ul",{id:"dropdown-menu-tags",class:"dropdown-menu-tags",style:y([n(X)?"":"border: none;"])},[(f(!0),e(i,null,r(n(H),a=>l((f(),e("span",null,[l(o("h6",{class:"p-1 mb-0",style:y("background-color: "+a.color+";")},g(a.name),5),[[t,n(Z)(a.id).filter(e=>e.id==a.id)[0].tags.length>0]]),(f(!0),e(i,null,r(n(Z)(a.id).filter(e=>e.id==a.id)[0].tags,(a,s)=>(f(),e("li",{key:s,class:h([{active:s===n($)},"dropdown-item dropdown-item-tags"]),onClick:e=>n(R)("addFromDropdownMenu",a)},[o("span",xa,g(a.name),1)],10,ha))),128))],512)),[[t,n(X)]])),256))],4)])])])]),o("div",ka,[o("input",{type:"file",onChange:S[9]||(S[9]=(...a)=>n(aa)&&n(aa)(...a))},null,32)]),n(E).originalBase64?(f(),b(A,{key:0,"screenshot-data":n(E),source:"addScreenshot"},null,8,["screenshot-data"])):c("",!0),l(o("p",Sa,Ca,512),[[t,n(E).originalBase64]]),o("div",Ia,[o("button",{type:"button",onClick:S[10]||(S[10]=(...a)=>n(ea)&&n(ea)(...a)),class:"btn btn-success btn-sm"},"Submit")]),ja],512),[[t,!n(P)]])],64))}};export{Oa as default};
